import csv
import numpy as np
import sys



w=[-0.8085625  -5.13188567 -0.47238496 -5.84781336 -3.64824554 -2.39285842
 -0.82527347  0.06969614 -0.06581962 -0.15331231 -0.77393375  0.33277009
  0.20437481  1.10872481  0.10277331  0.76980706  0.58036924  0.38543405
  1.10987174  1.00374466  1.29425022  1.01932796 -0.06234183 -0.10934409
 -0.90844811 -2.71252461  0.46647929 -1.71519344  1.0800591  -2.27465144
  0.0731602   0.37566326 -0.98107805 -0.49826774  0.1488868   0.58955263
  0.33054657  0.03469654 -0.03337991  1.31308616  0.11125303 -1.15988094
  0.79190635  0.48765866  0.38612479  0.15732932 -0.19243906 -0.60986421
 -0.6144105  -0.37209925 -0.62111111  0.31887297  0.03695369 -0.76678778
  0.732631    0.50604685  0.59354174  0.63015809 -1.6955899   0.05990427
 -0.2275359   0.11900915  0.18233301 -0.13371053 -1.34448144 -0.53145727
  0.64695089  0.70938577 -0.12523031  0.15550198 -0.03468737 -0.0192406
 -0.63669105 -0.88982931 -0.60086308  0.47353738 -0.18290259 -0.13472843
  0.75325514  0.24329874  0.31331928 -0.06524143  0.26407427 -0.29714995
 -0.85085667 -0.90894903 -0.28009316 -0.68002017  0.75906318  0.49892469
  0.73665747  1.05757606  0.49178665 -0.4784123  -0.01482063  0.04395367
  0.02737291 -0.12845351  0.62221538  0.34036042  0.40430373  0.11647242
 -0.38175922  0.51012517 -0.68836527  0.10609758]
b=5.10393136901
test = []
rowtest = csv.reader(open(sys.argv[1], 'r', encoding='big5'), delimiter=",")
i = -1  # 第一排沒資料
for r in rowtest:
    if i == -1:
        i = 0
        continue
    test.append([])
    for j in range(106):
        test[len(test)-1].append(float(r[j]))
test = np.array(test).transpose()

test_max=np.amax(test,axis=1)
test_min=np.amin(test,axis=1)
for i in range(6):
    if i!=2:
        test[i]=(test[i]-np.outer(test_min[i],np.ones(test.shape[1])))/(np.outer(test_max[i]-test_min[i],np.ones(test.shape[1])))



z = np.dot(w.reshape(1, 106), test)+b
z=z.reshape(z.shape[1])
print( 1/(1+np.exp(-z[4])))
pre = []
for i in range(len(z)):  # 從1開始跑
    pre.append([str(i+1)])
    if 1/(1+np.exp(-z[i])) > 0.5:
        pre[i].append(0)
    else:
        pre[i].append(1)
filename = sys.argv[2]
text = open(filename, "w+")
s = csv.writer(text, delimiter=',', lineterminator='\n')
s.writerow(["id", "label"])
for i in range(len(z)):
    s.writerow(pre[i])
text.close()
